#!/usr/bin/env node
/*
 * resteasy -- A rest API testing suite
 * 	test - Run the tests
 */
var fs = require("fs"),
	argv = require("optimist").argv;

// Global for the test files
global.resteasy = require("../cli/interface.js");

var command = argv._[0];

switch(command) {
	case "test":
		var filename = argv._[1];

		if(filename) {
			try {
				var file = require(process.cwd() + "/" + filename);
				resteasy.begin();
			} catch(e) {
				if(e.code == "MODULE_NOT_FOUND") oops("Can't find test file.");
			}
		} else {
			oops("Please supply a test file.");
		}
	break;

	case "help":
	default:
		help();
}

function oops(message) {
	console.log("Error: ".red + message);
	process.exit();
}

function help() {
	[
		"resteasy -- Simple REST API testing",
		"  help \t\t Shows this help.",
		"  test <file> \t Run a test file."
	].forEach(function(line) {
		console.log(line);
	});
}